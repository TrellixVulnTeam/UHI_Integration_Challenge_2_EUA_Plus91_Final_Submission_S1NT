import { __decorate } from "tslib";
import { HttpClient } from '@angular/common/http';
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, HostListener, Input, OnDestroy, OnInit, Output, TemplateRef, ViewChild, ViewContainerRef, } from '@angular/core';
import { of, Subject } from 'rxjs';
import { concat, debounceTime, distinctUntilChanged, filter, map, switchMap, tap, } from 'rxjs/operators';
import { Key } from './models';
import { createParamsForQuery, hasCharacters, isEnterKey, isEscapeKey, isIndexActive, resolveApiMethod, resolveNextIndex, toFormControlValue, toJsonpFinalResults, toJsonpSingleResult, validateArrowKeys, validateNonCharKeyCode, resolveItemValue, NO_INDEX, } from './ngx-typeahead.utils';
/*
 using an external template:
 <input [taItemTpl]="itemTpl" >

  <ng-template #itemTpl let-result>
    <strong>MY {{ result.result }}</strong>
  </ng-template>
*/
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common/http';
import * as ɵngcc2 from '@angular/common';

function NgxTypeAheadComponent_ng_template_0_section_0_button_2_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span");
    ɵngcc0.ɵɵelement(1, "i", 8);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var result_r4 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate1(" ", result_r4, "");
} }
function NgxTypeAheadComponent_ng_template_0_section_0_button_2_ng_template_2_Template(rf, ctx) { }
var _c0 = function (a0, a1) { return { result: a0, index: a1 }; };
var _c1 = function (a0) { return { $implicit: a0 }; };
function NgxTypeAheadComponent_ng_template_0_section_0_button_2_Template(rf, ctx) { if (rf & 1) {
    var _r10 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 5);
    ɵngcc0.ɵɵlistener("click", function NgxTypeAheadComponent_ng_template_0_section_0_button_2_Template_button_click_0_listener() { var restoredCtx = ɵngcc0.ɵɵrestoreView(_r10); var result_r4 = restoredCtx.$implicit; var i_r5 = restoredCtx.index; var ctx_r9 = ɵngcc0.ɵɵnextContext(3); return ctx_r9.handleSelectionClick(result_r4, i_r5); });
    ɵngcc0.ɵɵtemplate(1, NgxTypeAheadComponent_ng_template_0_section_0_button_2_span_1_Template, 3, 1, "span", 6);
    ɵngcc0.ɵɵtemplate(2, NgxTypeAheadComponent_ng_template_0_section_0_button_2_ng_template_2_Template, 0, 0, "ng-template", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var result_r4 = ctx.$implicit;
    var i_r5 = ctx.index;
    var ctx_r3 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵclassProp("active", ctx_r3.markIsActive(i_r5, result_r4));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r3.taItemTpl);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r3.taItemTpl)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(8, _c1, ɵngcc0.ɵɵpureFunction2(5, _c0, result_r4, i_r5)));
} }
function NgxTypeAheadComponent_ng_template_0_section_0_Template(rf, ctx) { if (rf & 1) {
    var _r12 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "section", 2);
    ɵngcc0.ɵɵelementStart(1, "div", 3);
    ɵngcc0.ɵɵlistener("click", function NgxTypeAheadComponent_ng_template_0_section_0_Template_div_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r12); var ctx_r11 = ɵngcc0.ɵɵnextContext(2); return ctx_r11.hideSuggestions(); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(2, NgxTypeAheadComponent_ng_template_0_section_0_button_2_Template, 3, 10, "button", 4);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r2 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r2.results);
} }
function NgxTypeAheadComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, NgxTypeAheadComponent_ng_template_0_section_0_Template, 3, 1, "section", 1);
} if (rf & 2) {
    var ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.showSuggestions);
} }
var NgxTypeAheadComponent = /** @class */ (function () {
    function NgxTypeAheadComponent(element, viewContainer, http, cdr) {
        this.element = element;
        this.viewContainer = viewContainer;
        this.http = http;
        this.cdr = cdr;
        this.showSuggestions = false;
        this.results = [];
        this.taUrl = '';
        this.taParams = {};
        this.taQueryParam = 'q';
        this.taApi = 'jsonp';
        this.taApiMethod = 'get';
        this.taList = [];
        this.taListItemField = [];
        this.taListItemLabel = '';
        this.taDebounce = 300;
        this.taAllowEmpty = false;
        this.taCaseSensitive = false;
        this.taDisplayOnFocus = false;
        this.taSelected = new EventEmitter();
        this.suggestionIndex = 0;
        this.subscriptions = [];
        this.activeResult = '';
        this.searchQuery = '';
        this.selectedItem = {};
        this.resultsAsItems = [];
        this.keydown$ = new Subject();
        this.keyup$ = new Subject();
    }
    NgxTypeAheadComponent.prototype.handleEsc = function (event) {
        if (isEscapeKey(event)) {
            this.hideSuggestions();
            event.preventDefault();
        }
        this.keydown$.next(event);
    };
    NgxTypeAheadComponent.prototype.onkeyup = function (event) {
        event.preventDefault();
        event.stopPropagation();
        this.keyup$.next(event);
    };
    NgxTypeAheadComponent.prototype.onClick = function () {
        if (this.taDisplayOnFocus) {
            this.displaySuggestions();
        }
    };
    NgxTypeAheadComponent.prototype.ngOnInit = function () {
        this.filterEnterEvent(this.keydown$);
        this.listenAndSuggest(this.keyup$);
        this.navigateWithArrows(this.keydown$);
        this.renderTemplate();
    };
    NgxTypeAheadComponent.prototype.ngOnDestroy = function () {
        this.keydown$.complete();
        this.keyup$.complete();
    };
    NgxTypeAheadComponent.prototype.renderTemplate = function () {
        if (!this.suggestionsTplRef) {
            console.error('NO NGXTA Template Found. Requires NG9');
            return;
        }
        this.viewContainer.createEmbeddedView(this.suggestionsTplRef);
        this.cdr.markForCheck();
    };
    NgxTypeAheadComponent.prototype.listenAndSuggest = function (obs) {
        var _this = this;
        obs
            .pipe(
        // tslint:disable-next-line: deprecation
        filter(function (e) { return validateNonCharKeyCode(e.code); }), map(toFormControlValue), debounceTime(this.taDebounce), 
        // tslint:disable-next-line: deprecation
        concat(), distinctUntilChanged(), filter(function (query) { return _this.taAllowEmpty || hasCharacters(query); }), tap(function (query) { return (_this.searchQuery = query); }), switchMap(function (query) { return _this.suggest(query); }))
            .subscribe(function (results) {
            _this.assignResults(results);
            // this.updateIndex(Key.ArrowDown);
            _this.displaySuggestions();
        });
    };
    NgxTypeAheadComponent.prototype.assignResults = function (results) {
        var labelForDisplay = this.taListItemLabel;
        this.resultsAsItems = results;
        this.results = results.map(function (item) {
            return labelForDisplay ? item[labelForDisplay] : item;
        });
        this.suggestionIndex = NO_INDEX;
        if (!results || !results.length) {
            this.activeResult = this.searchQuery;
        }
    };
    NgxTypeAheadComponent.prototype.filterEnterEvent = function (elementObs) {
        var _this = this;
        elementObs.pipe(filter(isEnterKey)).subscribe(function (event) {
            _this.handleSelectSuggestion(_this.activeResult);
        });
    };
    NgxTypeAheadComponent.prototype.navigateWithArrows = function (elementObs) {
        var _this = this;
        elementObs
            .pipe(map(function (e) { return e.key; }), filter(function (key) { return validateArrowKeys(key); }))
            .subscribe(function (key) {
            _this.updateIndex(key);
            _this.displaySuggestions();
        });
    };
    NgxTypeAheadComponent.prototype.updateIndex = function (keyCode) {
        this.suggestionIndex = resolveNextIndex(this.suggestionIndex, keyCode === Key.ArrowDown, this.results.length);
    };
    NgxTypeAheadComponent.prototype.displaySuggestions = function () {
        this.showSuggestions = true;
        this.cdr.markForCheck();
    };
    NgxTypeAheadComponent.prototype.suggest = function (query) {
        return this.taList.length
            ? this.createListSource(this.taList, query)
            : this.request(query);
    };
    /**
     * peforms a jsonp/http request to search with query and params
     * @param query the query to search from the remote source
     */
    NgxTypeAheadComponent.prototype.request = function (query) {
        var url = this.taUrl;
        var searchConfig = createParamsForQuery(query, this.taQueryParam, this.taParams);
        var options = {
            params: searchConfig,
        };
        var isJsonpApi = this.taApi === 'jsonp';
        return isJsonpApi
            ? this.requestJsonp(url, options, this.taCallbackParamValue)
            : this.requestHttp(url, options);
    };
    NgxTypeAheadComponent.prototype.requestHttp = function (url, options) {
        var apiMethod = resolveApiMethod(this.taApiMethod);
        return this.http[apiMethod](url, options);
    };
    NgxTypeAheadComponent.prototype.requestJsonp = function (url, options, callback) {
        if (callback === void 0) { callback = 'callback'; }
        var params = options.params.toString();
        return this.http
            .jsonp(url + "?" + params, callback)
            .pipe(map(toJsonpSingleResult), map(toJsonpFinalResults));
    };
    NgxTypeAheadComponent.prototype.markIsActive = function (index, result) {
        var isActive = isIndexActive(index, this.suggestionIndex);
        if (isActive) {
            this.activeResult = result;
        }
        return isActive;
    };
    NgxTypeAheadComponent.prototype.handleSelectionClick = function (suggestion, index) {
        this.suggestionIndex = index;
        this.handleSelectSuggestion(suggestion);
    };
    NgxTypeAheadComponent.prototype.handleSelectSuggestion = function (suggestion) {
        var result = this.resultsAsItems.length
            ? this.resultsAsItems[this.suggestionIndex]
            : suggestion;
        this.hideSuggestions();
        var resolvedResult = this.suggestionIndex === NO_INDEX ? this.searchQuery : result;
        this.taSelected.emit(resolvedResult);
    };
    NgxTypeAheadComponent.prototype.hideSuggestions = function () {
        this.showSuggestions = false;
    };
    NgxTypeAheadComponent.prototype.hasItemTemplate = function () {
        return this.taItemTpl !== undefined;
    };
    NgxTypeAheadComponent.prototype.createListSource = function (list, query) {
        var _this = this;
        var sanitizedQuery = this.taCaseSensitive ? query : query.toLowerCase();
        var fieldsToExtract = this.taListItemField;
        return of(list.filter(function (item) {
            return resolveItemValue(item, fieldsToExtract, _this.taCaseSensitive).includes(sanitizedQuery);
        }));
    };
    NgxTypeAheadComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ViewContainerRef },
        { type: HttpClient },
        { type: ChangeDetectorRef }
    ]; };
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taItemTpl", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taUrl", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taParams", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taQueryParam", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taCallbackParamValue", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taApi", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taApiMethod", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taList", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taListItemField", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taListItemLabel", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taDebounce", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taAllowEmpty", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taCaseSensitive", void 0);
    __decorate([
        Input()
    ], NgxTypeAheadComponent.prototype, "taDisplayOnFocus", void 0);
    __decorate([
        Output()
    ], NgxTypeAheadComponent.prototype, "taSelected", void 0);
    __decorate([
        ViewChild(TemplateRef, { static: true })
    ], NgxTypeAheadComponent.prototype, "suggestionsTplRef", void 0);
    __decorate([
        HostListener('keydown', ['$event'])
    ], NgxTypeAheadComponent.prototype, "handleEsc", null);
    __decorate([
        HostListener('keyup', ['$event'])
    ], NgxTypeAheadComponent.prototype, "onkeyup", null);
    __decorate([
        HostListener('click')
    ], NgxTypeAheadComponent.prototype, "onClick", null);
NgxTypeAheadComponent.ɵfac = function NgxTypeAheadComponent_Factory(t) { return new (t || NgxTypeAheadComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.HttpClient), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
NgxTypeAheadComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: NgxTypeAheadComponent, selectors: [["ngx-typeahead"], ["", "ngxTypeahead", ""]], viewQuery: function NgxTypeAheadComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(TemplateRef, 7);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.suggestionsTplRef = _t.first);
    } }, hostBindings: function NgxTypeAheadComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("keydown", function NgxTypeAheadComponent_keydown_HostBindingHandler($event) { return ctx.handleEsc($event); })("keyup", function NgxTypeAheadComponent_keyup_HostBindingHandler($event) { return ctx.onkeyup($event); })("click", function NgxTypeAheadComponent_click_HostBindingHandler() { return ctx.onClick(); });
    } }, inputs: { taUrl: "taUrl", taParams: "taParams", taQueryParam: "taQueryParam", taApi: "taApi", taApiMethod: "taApiMethod", taList: "taList", taListItemField: "taListItemField", taListItemLabel: "taListItemLabel", taDebounce: "taDebounce", taAllowEmpty: "taAllowEmpty", taCaseSensitive: "taCaseSensitive", taDisplayOnFocus: "taDisplayOnFocus", taItemTpl: "taItemTpl", taCallbackParamValue: "taCallbackParamValue" }, outputs: { taSelected: "taSelected" }, decls: 2, vars: 0, consts: [["suggestionsTplRef", ""], ["class", "ta-results list-group", 4, "ngIf"], [1, "ta-results", "list-group"], [1, "ta-backdrop", 3, "click"], ["type", "button", "class", "ta-item list-group-item", 3, "active", "click", 4, "ngFor", "ngForOf"], ["type", "button", 1, "ta-item", "list-group-item", 3, "click"], [4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "fa", "fa-search"]], template: function NgxTypeAheadComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, NgxTypeAheadComponent_ng_template_0_Template, 1, 1, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: [ɵngcc2.NgIf, ɵngcc2.NgForOf, ɵngcc2.NgTemplateOutlet], styles: [".ta-results[_ngcontent-%COMP%] {\n        position: absolute;\n      }\n      .ta-backdrop[_ngcontent-%COMP%] {\n        bottom: 0;\n        left: 0;\n        position: fixed;\n        right: 0;\n        top: 0;\n        z-index: 1;\n      }\n      .ta-item[_ngcontent-%COMP%] {\n        position: relative;\n        z-index: 2;\n        display: block;\n      }"] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgxTypeAheadComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line: component-selector
                selector: 'ngx-typeahead, [ngxTypeahead]',
                template: "\n    <ng-template #suggestionsTplRef>\n      <section class=\"ta-results list-group\" *ngIf=\"showSuggestions\">\n        <div class=\"ta-backdrop\" (click)=\"hideSuggestions()\"></div>\n        <button\n          type=\"button\"\n          class=\"ta-item list-group-item\"\n          *ngFor=\"let result of results; let i = index\"\n          [class.active]=\"markIsActive(i, result)\"\n          (click)=\"handleSelectionClick(result, i)\"\n        >\n          <span *ngIf=\"!taItemTpl\"\n            ><i class=\"fa fa-search\"></i> {{ result }}</span\n          >\n          <ng-template\n            [ngTemplateOutlet]=\"taItemTpl\"\n            [ngTemplateOutletContext]=\"{\n              $implicit: { result: result, index: i }\n            }\"\n          ></ng-template>\n        </button>\n      </section>\n    </ng-template>\n  ",
                styles: ["\n      .ta-results {\n        position: absolute;\n      }\n      .ta-backdrop {\n        bottom: 0;\n        left: 0;\n        position: fixed;\n        right: 0;\n        top: 0;\n        z-index: 1;\n      }\n      .ta-item {\n        position: relative;\n        z-index: 2;\n        display: block;\n      }\n    "]
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.ViewContainerRef }, { type: ɵngcc1.HttpClient }, { type: ɵngcc0.ChangeDetectorRef }]; }, { taUrl: [{
            type: Input
        }], taParams: [{
            type: Input
        }], taQueryParam: [{
            type: Input
        }], taApi: [{
            type: Input
        }], taApiMethod: [{
            type: Input
        }], taList: [{
            type: Input
        }], taListItemField: [{
            type: Input
        }], taListItemLabel: [{
            type: Input
        }], taDebounce: [{
            type: Input
        }], taAllowEmpty: [{
            type: Input
        }], taCaseSensitive: [{
            type: Input
        }], taDisplayOnFocus: [{
            type: Input
        }], taSelected: [{
            type: Output
        }], handleEsc: [{
            type: HostListener,
            args: ['keydown', ['$event']]
        }], onkeyup: [{
            type: HostListener,
            args: ['keyup', ['$event']]
        }], onClick: [{
            type: HostListener,
            args: ['click']
        }], taItemTpl: [{
            type: Input
        }], taCallbackParamValue: [{
            type: Input
        }], suggestionsTplRef: [{
            type: ViewChild,
            args: [TemplateRef, { static: true }]
        }] }); })();
    return NgxTypeAheadComponent;
}());
export { NgxTypeAheadComponent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXR5cGVhaGVhZC5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIm5neC10eXBlYWhlYWQvbGliL25neC10eXBlYWhlYWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbEQsT0FBTyxFQUNMLGlCQUFpQixFQUNqQixTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixZQUFZLEVBQ1osS0FBSyxFQUNMLFNBQVMsRUFDVCxNQUFNLEVBQ04sTUFBTSxFQUNOLFdBQVcsRUFDWCxTQUFTLEVBQ1QsZ0JBQWdCLEdBQ2pCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxFQUFFLEVBQWMsT0FBTyxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUM3RCxPQUFPLEVBQ0wsTUFBTSxFQUNOLFlBQVksRUFDWixvQkFBb0IsRUFDcEIsTUFBTSxFQUNOLEdBQUcsRUFDSCxTQUFTLEVBQ1QsR0FBRyxHQUNKLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEIsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUMvQixPQUFPLEVBQ0wsb0JBQW9CLEVBQ3BCLGFBQWEsRUFDYixVQUFVLEVBQ1YsV0FBVyxFQUNYLGFBQWEsRUFDYixnQkFBZ0IsRUFDaEIsZ0JBQWdCLEVBQ2hCLGtCQUFrQixFQUNsQixtQkFBbUIsRUFDbkIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQixzQkFBc0IsRUFDdEIsZ0JBQWdCLEVBQ2hCLFFBQVEsR0FDVCxNQUFNLHVCQUF1QixDQUFDO0FBRS9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaURGO0FBQXlELElBZ0R2RCwrQkFDVSxPQUFtQixFQUNuQixhQUErQixFQUMvQixJQUFnQixFQUNoQixHQUFzQjtBQUMv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J0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7XG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSG9zdExpc3RlbmVyLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NvbnRhaW5lclJlZixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBvZiwgT2JzZXJ2YWJsZSwgU3ViamVjdCwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge1xuICBjb25jYXQsXG4gIGRlYm91bmNlVGltZSxcbiAgZGlzdGluY3RVbnRpbENoYW5nZWQsXG4gIGZpbHRlcixcbiAgbWFwLFxuICBzd2l0Y2hNYXAsXG4gIHRhcCxcbn0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgS2V5IH0gZnJvbSAnLi9tb2RlbHMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlUGFyYW1zRm9yUXVlcnksXG4gIGhhc0NoYXJhY3RlcnMsXG4gIGlzRW50ZXJLZXksXG4gIGlzRXNjYXBlS2V5LFxuICBpc0luZGV4QWN0aXZlLFxuICByZXNvbHZlQXBpTWV0aG9kLFxuICByZXNvbHZlTmV4dEluZGV4LFxuICB0b0Zvcm1Db250cm9sVmFsdWUsXG4gIHRvSnNvbnBGaW5hbFJlc3VsdHMsXG4gIHRvSnNvbnBTaW5nbGVSZXN1bHQsXG4gIHZhbGlkYXRlQXJyb3dLZXlzLFxuICB2YWxpZGF0ZU5vbkNoYXJLZXlDb2RlLFxuICByZXNvbHZlSXRlbVZhbHVlLFxuICBOT19JTkRFWCxcbn0gZnJvbSAnLi9uZ3gtdHlwZWFoZWFkLnV0aWxzJztcblxuLypcbiB1c2luZyBhbiBleHRlcm5hbCB0ZW1wbGF0ZTpcbiA8aW5wdXQgW3RhSXRlbVRwbF09XCJpdGVtVHBsXCIgPlxuXG4gIDxuZy10ZW1wbGF0ZSAjaXRlbVRwbCBsZXQtcmVzdWx0PlxuICAgIDxzdHJvbmc+TVkge3sgcmVzdWx0LnJlc3VsdCB9fTwvc3Ryb25nPlxuICA8L25nLXRlbXBsYXRlPlxuKi9cbkBDb21wb25lbnQoe1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IGNvbXBvbmVudC1zZWxlY3RvclxuICBzZWxlY3RvcjogJ25neC10eXBlYWhlYWQsIFtuZ3hUeXBlYWhlYWRdJyxcbiAgc3R5bGVzOiBbXG4gICAgYFxuICAgICAgLnRhLXJlc3VsdHMge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICB9XG4gICAgICAudGEtYmFja2Ryb3Age1xuICAgICAgICBib3R0b206IDA7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgcmlnaHQ6IDA7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgei1pbmRleDogMTtcbiAgICAgIH1cbiAgICAgIC50YS1pdGVtIHtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICB6LWluZGV4OiAyO1xuICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgIH1cbiAgICBgLFxuICBdLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxuZy10ZW1wbGF0ZSAjc3VnZ2VzdGlvbnNUcGxSZWY+XG4gICAgICA8c2VjdGlvbiBjbGFzcz1cInRhLXJlc3VsdHMgbGlzdC1ncm91cFwiICpuZ0lmPVwic2hvd1N1Z2dlc3Rpb25zXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0YS1iYWNrZHJvcFwiIChjbGljayk9XCJoaWRlU3VnZ2VzdGlvbnMoKVwiPjwvZGl2PlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgY2xhc3M9XCJ0YS1pdGVtIGxpc3QtZ3JvdXAtaXRlbVwiXG4gICAgICAgICAgKm5nRm9yPVwibGV0IHJlc3VsdCBvZiByZXN1bHRzOyBsZXQgaSA9IGluZGV4XCJcbiAgICAgICAgICBbY2xhc3MuYWN0aXZlXT1cIm1hcmtJc0FjdGl2ZShpLCByZXN1bHQpXCJcbiAgICAgICAgICAoY2xpY2spPVwiaGFuZGxlU2VsZWN0aW9uQ2xpY2socmVzdWx0LCBpKVwiXG4gICAgICAgID5cbiAgICAgICAgICA8c3BhbiAqbmdJZj1cIiF0YUl0ZW1UcGxcIlxuICAgICAgICAgICAgPjxpIGNsYXNzPVwiZmEgZmEtc2VhcmNoXCI+PC9pPiB7eyByZXN1bHQgfX08L3NwYW5cbiAgICAgICAgICA+XG4gICAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJ0YUl0ZW1UcGxcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgJGltcGxpY2l0OiB7IHJlc3VsdDogcmVzdWx0LCBpbmRleDogaSB9XG4gICAgICAgICAgICB9XCJcbiAgICAgICAgICA+PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L3NlY3Rpb24+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgYCxcbn0pXG5leHBvcnQgY2xhc3MgTmd4VHlwZUFoZWFkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuICBzaG93U3VnZ2VzdGlvbnMgPSBmYWxzZTtcbiAgcmVzdWx0czogc3RyaW5nW10gPSBbXTtcblxuICBASW5wdXQoKVxuICB0YUl0ZW1UcGwhOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASW5wdXQoKVxuICB0YVVybCA9ICcnO1xuICBASW5wdXQoKVxuICB0YVBhcmFtcyA9IHt9O1xuICBASW5wdXQoKVxuICB0YVF1ZXJ5UGFyYW0gPSAncSc7XG4gIEBJbnB1dCgpXG4gIHRhQ2FsbGJhY2tQYXJhbVZhbHVlO1xuICBASW5wdXQoKVxuICB0YUFwaSA9ICdqc29ucCc7XG4gIEBJbnB1dCgpXG4gIHRhQXBpTWV0aG9kID0gJ2dldCc7XG4gIEBJbnB1dCgpXG4gIHRhTGlzdCA9IFtdO1xuICBASW5wdXQoKVxuICB0YUxpc3RJdGVtRmllbGQgPSBbXTtcbiAgQElucHV0KClcbiAgdGFMaXN0SXRlbUxhYmVsID0gJyc7XG4gIEBJbnB1dCgpXG4gIHRhRGVib3VuY2UgPSAzMDA7XG4gIEBJbnB1dCgpXG4gIHRhQWxsb3dFbXB0eSA9IGZhbHNlO1xuICBASW5wdXQoKVxuICB0YUNhc2VTZW5zaXRpdmUgPSBmYWxzZTtcbiAgQElucHV0KClcbiAgdGFEaXNwbGF5T25Gb2N1cyA9IGZhbHNlO1xuXG4gIEBPdXRwdXQoKVxuICB0YVNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmcgfCBhbnk+KCk7XG5cbiAgQFZpZXdDaGlsZChUZW1wbGF0ZVJlZiwgeyBzdGF0aWM6IHRydWUgfSlcbiAgc3VnZ2VzdGlvbnNUcGxSZWY6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgcHJpdmF0ZSBzdWdnZXN0aW9uSW5kZXggPSAwO1xuICBwcml2YXRlIHN1YnNjcmlwdGlvbnM6IFN1YnNjcmlwdGlvbltdID0gW107XG4gIHByaXZhdGUgYWN0aXZlUmVzdWx0ID0gJyc7XG4gIHByaXZhdGUgc2VhcmNoUXVlcnkgPSAnJztcbiAgcHJpdmF0ZSBzZWxlY3RlZEl0ZW06IGFueSA9IHt9O1xuICBwcml2YXRlIHJlc3VsdHNBc0l0ZW1zOiBhbnlbXSA9IFtdO1xuICBwcml2YXRlIGtleWRvd24kID0gbmV3IFN1YmplY3Q8S2V5Ym9hcmRFdmVudD4oKTtcbiAgcHJpdmF0ZSBrZXl1cCQgPSBuZXcgU3ViamVjdDxLZXlib2FyZEV2ZW50PigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIHZpZXdDb250YWluZXI6IFZpZXdDb250YWluZXJSZWYsXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxuICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZlxuICApIHt9XG5cbiAgQEhvc3RMaXN0ZW5lcigna2V5ZG93bicsIFsnJGV2ZW50J10pXG4gIGhhbmRsZUVzYyhldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgIGlmIChpc0VzY2FwZUtleShldmVudCkpIHtcbiAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICB0aGlzLmtleWRvd24kLm5leHQoZXZlbnQpO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcigna2V5dXAnLCBbJyRldmVudCddKVxuICBvbmtleXVwKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLmtleXVwJC5uZXh0KGV2ZW50KTtcbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJylcbiAgb25DbGljaygpIHtcbiAgICBpZiAodGhpcy50YURpc3BsYXlPbkZvY3VzKSB7XG4gICAgICB0aGlzLmRpc3BsYXlTdWdnZXN0aW9ucygpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuZmlsdGVyRW50ZXJFdmVudCh0aGlzLmtleWRvd24kKTtcbiAgICB0aGlzLmxpc3RlbkFuZFN1Z2dlc3QodGhpcy5rZXl1cCQpO1xuICAgIHRoaXMubmF2aWdhdGVXaXRoQXJyb3dzKHRoaXMua2V5ZG93biQpO1xuICAgIHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMua2V5ZG93biQuY29tcGxldGUoKTtcbiAgICB0aGlzLmtleXVwJC5jb21wbGV0ZSgpO1xuICB9XG5cbiAgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25zVHBsUmVmKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdOTyBOR1hUQSBUZW1wbGF0ZSBGb3VuZC4gUmVxdWlyZXMgTkc5Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudmlld0NvbnRhaW5lci5jcmVhdGVFbWJlZGRlZFZpZXcodGhpcy5zdWdnZXN0aW9uc1RwbFJlZik7XG4gICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gIH1cblxuICBsaXN0ZW5BbmRTdWdnZXN0KG9iczogU3ViamVjdDxLZXlib2FyZEV2ZW50Pikge1xuICAgIG9ic1xuICAgICAgLnBpcGUoXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogZGVwcmVjYXRpb25cbiAgICAgICAgZmlsdGVyKChlOiBLZXlib2FyZEV2ZW50KSA9PiB2YWxpZGF0ZU5vbkNoYXJLZXlDb2RlKGUuY29kZSkpLFxuICAgICAgICBtYXAodG9Gb3JtQ29udHJvbFZhbHVlKSxcbiAgICAgICAgZGVib3VuY2VUaW1lKHRoaXMudGFEZWJvdW5jZSksXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogZGVwcmVjYXRpb25cbiAgICAgICAgY29uY2F0KCksXG4gICAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCksXG4gICAgICAgIGZpbHRlcigocXVlcnk6IHN0cmluZykgPT4gdGhpcy50YUFsbG93RW1wdHkgfHwgaGFzQ2hhcmFjdGVycyhxdWVyeSkpLFxuICAgICAgICB0YXAoKHF1ZXJ5OiBzdHJpbmcpID0+ICh0aGlzLnNlYXJjaFF1ZXJ5ID0gcXVlcnkpKSxcbiAgICAgICAgc3dpdGNoTWFwKChxdWVyeTogc3RyaW5nKSA9PiB0aGlzLnN1Z2dlc3QocXVlcnkpKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgocmVzdWx0czogc3RyaW5nW10gfCBhbnkpID0+IHtcbiAgICAgICAgdGhpcy5hc3NpZ25SZXN1bHRzKHJlc3VsdHMpO1xuICAgICAgICAvLyB0aGlzLnVwZGF0ZUluZGV4KEtleS5BcnJvd0Rvd24pO1xuICAgICAgICB0aGlzLmRpc3BsYXlTdWdnZXN0aW9ucygpO1xuICAgICAgfSk7XG4gIH1cblxuICBhc3NpZ25SZXN1bHRzKHJlc3VsdHM6IGFueVtdKSB7XG4gICAgY29uc3QgbGFiZWxGb3JEaXNwbGF5ID0gdGhpcy50YUxpc3RJdGVtTGFiZWw7XG4gICAgdGhpcy5yZXN1bHRzQXNJdGVtcyA9IHJlc3VsdHM7XG4gICAgdGhpcy5yZXN1bHRzID0gcmVzdWx0cy5tYXAoKGl0ZW06IHN0cmluZyB8IGFueSkgPT5cbiAgICAgIGxhYmVsRm9yRGlzcGxheSA/IGl0ZW1bbGFiZWxGb3JEaXNwbGF5XSA6IGl0ZW1cbiAgICApO1xuICAgIHRoaXMuc3VnZ2VzdGlvbkluZGV4ID0gTk9fSU5ERVg7XG4gICAgaWYgKCFyZXN1bHRzIHx8ICFyZXN1bHRzLmxlbmd0aCkge1xuICAgICAgdGhpcy5hY3RpdmVSZXN1bHQgPSB0aGlzLnNlYXJjaFF1ZXJ5O1xuICAgIH1cbiAgfVxuXG4gIGZpbHRlckVudGVyRXZlbnQoZWxlbWVudE9iczogU3ViamVjdDxLZXlib2FyZEV2ZW50Pikge1xuICAgIGVsZW1lbnRPYnMucGlwZShmaWx0ZXIoaXNFbnRlcktleSkpLnN1YnNjcmliZSgoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlU2VsZWN0U3VnZ2VzdGlvbih0aGlzLmFjdGl2ZVJlc3VsdCk7XG4gICAgfSk7XG4gIH1cblxuICBuYXZpZ2F0ZVdpdGhBcnJvd3MoZWxlbWVudE9iczogU3ViamVjdDxLZXlib2FyZEV2ZW50Pikge1xuICAgIGVsZW1lbnRPYnNcbiAgICAgIC5waXBlKFxuICAgICAgICBtYXAoKGU6IGFueSkgPT4gZS5rZXkpLFxuICAgICAgICBmaWx0ZXIoKGtleTogS2V5KSA9PiB2YWxpZGF0ZUFycm93S2V5cyhrZXkpKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoa2V5OiBLZXkpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVJbmRleChrZXkpO1xuICAgICAgICB0aGlzLmRpc3BsYXlTdWdnZXN0aW9ucygpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVJbmRleChrZXlDb2RlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnN1Z2dlc3Rpb25JbmRleCA9IHJlc29sdmVOZXh0SW5kZXgoXG4gICAgICB0aGlzLnN1Z2dlc3Rpb25JbmRleCxcbiAgICAgIGtleUNvZGUgPT09IEtleS5BcnJvd0Rvd24sXG4gICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoXG4gICAgKTtcbiAgfVxuXG4gIGRpc3BsYXlTdWdnZXN0aW9ucygpIHtcbiAgICB0aGlzLnNob3dTdWdnZXN0aW9ucyA9IHRydWU7XG4gICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gIH1cblxuICBzdWdnZXN0KHF1ZXJ5OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy50YUxpc3QubGVuZ3RoXG4gICAgICA/IHRoaXMuY3JlYXRlTGlzdFNvdXJjZSh0aGlzLnRhTGlzdCwgcXVlcnkpXG4gICAgICA6IHRoaXMucmVxdWVzdChxdWVyeSk7XG4gIH1cblxuICAvKipcbiAgICogcGVmb3JtcyBhIGpzb25wL2h0dHAgcmVxdWVzdCB0byBzZWFyY2ggd2l0aCBxdWVyeSBhbmQgcGFyYW1zXG4gICAqIEBwYXJhbSBxdWVyeSB0aGUgcXVlcnkgdG8gc2VhcmNoIGZyb20gdGhlIHJlbW90ZSBzb3VyY2VcbiAgICovXG4gIHJlcXVlc3QocXVlcnk6IHN0cmluZykge1xuICAgIGNvbnN0IHVybCA9IHRoaXMudGFVcmw7XG4gICAgY29uc3Qgc2VhcmNoQ29uZmlnID0gY3JlYXRlUGFyYW1zRm9yUXVlcnkoXG4gICAgICBxdWVyeSxcbiAgICAgIHRoaXMudGFRdWVyeVBhcmFtLFxuICAgICAgdGhpcy50YVBhcmFtc1xuICAgICk7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHBhcmFtczogc2VhcmNoQ29uZmlnLFxuICAgIH07XG4gICAgY29uc3QgaXNKc29ucEFwaSA9IHRoaXMudGFBcGkgPT09ICdqc29ucCc7XG4gICAgcmV0dXJuIGlzSnNvbnBBcGlcbiAgICAgID8gdGhpcy5yZXF1ZXN0SnNvbnAodXJsLCBvcHRpb25zLCB0aGlzLnRhQ2FsbGJhY2tQYXJhbVZhbHVlKVxuICAgICAgOiB0aGlzLnJlcXVlc3RIdHRwKHVybCwgb3B0aW9ucyk7XG4gIH1cblxuICByZXF1ZXN0SHR0cCh1cmw6IHN0cmluZywgb3B0aW9ucykge1xuICAgIGNvbnN0IGFwaU1ldGhvZCA9IHJlc29sdmVBcGlNZXRob2QodGhpcy50YUFwaU1ldGhvZCk7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFthcGlNZXRob2RdKHVybCwgb3B0aW9ucyk7XG4gIH1cblxuICByZXF1ZXN0SnNvbnAodXJsLCBvcHRpb25zLCBjYWxsYmFjayA9ICdjYWxsYmFjaycpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBvcHRpb25zLnBhcmFtcy50b1N0cmluZygpO1xuICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgIC5qc29ucChgJHt1cmx9PyR7cGFyYW1zfWAsIGNhbGxiYWNrKVxuICAgICAgLnBpcGUobWFwKHRvSnNvbnBTaW5nbGVSZXN1bHQpLCBtYXAodG9Kc29ucEZpbmFsUmVzdWx0cykpO1xuICB9XG5cbiAgbWFya0lzQWN0aXZlKGluZGV4OiBudW1iZXIsIHJlc3VsdDogc3RyaW5nKSB7XG4gICAgY29uc3QgaXNBY3RpdmUgPSBpc0luZGV4QWN0aXZlKGluZGV4LCB0aGlzLnN1Z2dlc3Rpb25JbmRleCk7XG4gICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICB0aGlzLmFjdGl2ZVJlc3VsdCA9IHJlc3VsdDtcbiAgICB9XG4gICAgcmV0dXJuIGlzQWN0aXZlO1xuICB9XG5cbiAgaGFuZGxlU2VsZWN0aW9uQ2xpY2soc3VnZ2VzdGlvbjogc3RyaW5nLCBpbmRleDogbnVtYmVyKSB7XG4gICAgdGhpcy5zdWdnZXN0aW9uSW5kZXggPSBpbmRleDtcbiAgICB0aGlzLmhhbmRsZVNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbik7XG4gIH1cblxuICBoYW5kbGVTZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IHN0cmluZykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0c0FzSXRlbXMubGVuZ3RoXG4gICAgICA/IHRoaXMucmVzdWx0c0FzSXRlbXNbdGhpcy5zdWdnZXN0aW9uSW5kZXhdXG4gICAgICA6IHN1Z2dlc3Rpb247XG4gICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICBjb25zdCByZXNvbHZlZFJlc3VsdCA9XG4gICAgICB0aGlzLnN1Z2dlc3Rpb25JbmRleCA9PT0gTk9fSU5ERVggPyB0aGlzLnNlYXJjaFF1ZXJ5IDogcmVzdWx0O1xuICAgIHRoaXMudGFTZWxlY3RlZC5lbWl0KHJlc29sdmVkUmVzdWx0KTtcbiAgfVxuXG4gIGhpZGVTdWdnZXN0aW9ucygpIHtcbiAgICB0aGlzLnNob3dTdWdnZXN0aW9ucyA9IGZhbHNlO1xuICB9XG5cbiAgaGFzSXRlbVRlbXBsYXRlKCkge1xuICAgIHJldHVybiB0aGlzLnRhSXRlbVRwbCAhPT0gdW5kZWZpbmVkO1xuICB9XG5cbiAgY3JlYXRlTGlzdFNvdXJjZShsaXN0OiBhbnlbXSwgcXVlcnk6IHN0cmluZyk6IE9ic2VydmFibGU8c3RyaW5nW10+IHtcbiAgICBjb25zdCBzYW5pdGl6ZWRRdWVyeSA9IHRoaXMudGFDYXNlU2Vuc2l0aXZlID8gcXVlcnkgOiBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IGZpZWxkc1RvRXh0cmFjdCA9IHRoaXMudGFMaXN0SXRlbUZpZWxkO1xuICAgIHJldHVybiBvZihcbiAgICAgIGxpc3QuZmlsdGVyKChpdGVtOiBzdHJpbmcgfCBhbnkpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmVJdGVtVmFsdWUoXG4gICAgICAgICAgaXRlbSxcbiAgICAgICAgICBmaWVsZHNUb0V4dHJhY3QsXG4gICAgICAgICAgdGhpcy50YUNhc2VTZW5zaXRpdmVcbiAgICAgICAgKS5pbmNsdWRlcyhzYW5pdGl6ZWRRdWVyeSk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cbn1cbiJdfQ==