{"version":3,"sources":["webpack:///src/app/pages/dashboard/search-results/search-results-routing.module.ts","webpack:///src/app/pages/dashboard/search-results/search-results.module.ts","webpack:///src/app/pages/dashboard/search-results/search-results.page.html","webpack:///src/app/pages/dashboard/search-results/search-results.page.ts"],"names":["routes","path","component","SearchResultsPage","SearchResultsPageRoutingModule","RouterModule","SearchResultsPageModule","CommonModule","FormsModule","IonicModule","_router","_api","_commonService","isSocketTrigger","searchResults","hasOwnProperty","fulfillments","transaction_id","undefined","navigate","setTimeout","get_onSearchData","SOCKET","on","data","res","status_code","message","catalog","forEach","fulfillment","items","item","parseInt","id","fulfillment_id","fulfillmentObj","context","tempArr","JSON","stringify","push","parse","console","log","length","param","presentLoading","subscribe","results","request_body","sortData","err","error","index"],"mappings":"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","file":"src_app_pages_dashboard_search-results_search-results_module_ts-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SearchResultsPage } from './search-results.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchResultsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SearchResultsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SearchResultsPageRoutingModule } from './search-results-routing.module';\n\nimport { SearchResultsPage } from './search-results.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SearchResultsPageRoutingModule\n  ],\n  declarations: [SearchResultsPage]\n})\nexport class SearchResultsPageModule {}\n","<ion-header [translucent]=\"true\">\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title>Search Results</ion-title>\n    <ion-buttons slot=\"secondary\">\n      <ion-back-button defaultHref=\"/dashboard/home\"></ion-back-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content [fullscreen]=\"true\">\n  <div class=\"container-fluid w-100 h-100 p-3\">\n\n    <div *ngIf=\"_commonService.searchResults.fulfillments.length==0\" class=\"col-12 text-center\">\n      No Doctors Found\n    </div>\n\n    <div *ngIf=\"_commonService.searchResults.fulfillments.length>0\" class=\"d-block w-100 h-100\">\n\n      <div *ngFor=\"let fulfillment of this._commonService.searchResults.fulfillments;index as i;\" class=\"d-block col-12\">\n        <ion-card class=\"m-0 p-0 mb-3\">\n          <ion-item class=\"border-0\">\n            <div class=\"h-100\" style=\"padding-top: 5px;padding-bottom: 5px;\">\n              <img [src]=\"fulfillment.agent.gender=='M'?'assets/male-doctor.png':'assets/female-doctor.png'\" alt=\"\" style=\"width: 60px;margin: 5px 15px 5px 0px;border-radius: 100%;\">\n            </div>\n            <ion-label>\n              {{ fulfillment.agent.name }}<br>\n              <span class=\"text-muted fs-14\">{{ fulfillment.type }} / {{fulfillment.items.descriptor.name}} {{fulfillment.agent.tags[\"@abdm/gov/in/education\"]?\"/\"+fulfillment.agent.tags[\"@abdm/gov/in/education\"]:\"\"}}</span><br>\n              <span style=\"color: #3880ff;\"><b>{{fulfillment.agent.tags[\"@abdm/gov/in/hpr_id\"]}}</b></span><br *ngIf=\"fulfillment.agent.tags['@abdm/gov/in/hpr_id']\">\n              <ion-card-subtitle>{{fulfillment.agent.tags[\"@abdm/gov/in/languages\"]}}<br>{{fulfillment.agent.tags[\"@abdm/gov/in/experience\"]}}</ion-card-subtitle>\n            </ion-label>\n          </ion-item>\n          \n          <ion-card-content class=\"m-0 p-2\">\n            <div class=\"d-flex flex-wrap justify-content-start\">\n              <ion-chip outline color=\"primary\" (click)=\"book_appointment(i,fulfillment);\">\n                <ion-label>\n                  <span style=\"color: red;font-size : 16px;font-weight: 700;\">Rs. {{fulfillment.items.price.value}}</span>\n                  <span style=\"font-size: 12px; font-weight:600;margin-left: 10px;color: var(--ion-color-primary);\">{{fulfillment.context.provider_id}}</span>\n                </ion-label>\n              </ion-chip>\n            </div>\n          </ion-card-content>\n        </ion-card>  \n      </div>\n    \n      <!-- <div *ngFor=\"let searchResult of _commonService.searchResults;index as i;\" class=\"d-block col-12\">\n        <ion-card>\n          <ion-item class=\"border-0\">\n            <div class=\"h-100\" style=\"padding-top: 5px;padding-bottom: 5px;\">\n              <img [src]=\"searchResult.doctor_img!=''?searchResult.doctor_img:searchResult.doctor_gender=='male'?'assets/male-doctor.png':'assets/female-doctor.png'\" alt=\"\" style=\"width: 60px;margin: 5px 15px 5px 0px;border-radius: 100%;\">\n            </div>\n            <ion-label>\n              {{ searchResult.doctor_name }}<br>\n              <span class=\"text-muted\">{{ searchResult.doctor_service_type }} {{searchResult.doctor_service_category}}</span><br>\n              <span style=\"color: #3880ff;\"><b>doctor.hrp@hpr.abdm</b></span><br>\n              <ion-card-subtitle class=\"mt-2\">Marathi / Hindi / English<br>12 Yrs of Experience</ion-card-subtitle>\n            </ion-label>\n          </ion-item>\n          \n          <ion-card-content class=\"m-0 p-2\">\n            <div class=\"d-flex flex-wrap justify-content-start\">\n              <ion-chip outline color=\"primary\" (click)=\"book_appointment(i,searchResult);\">\n                <ion-label>\n                  <span style=\"color: red;font-size : 16px;font-weight: 700;\">Rs. {{searchResult.quote.price.value}}</span>\n                  <span style=\"font-size: 12px; font-weight:600;margin-left: 10px;color: var(--ion-color-primary);\">{{searchResult.service_provider}}</span>\n                </ion-label>\n              </ion-chip>\n              <ion-button size=\"small\" (click)=\"book_appointment(searchResult);\">Book Appointment</ion-button>\n              <ion-button style=\"color: #3880ff;\" fill=\"\"><ion-icon color=\"primary\" slot=\"start\" name=\"calendar\"></ion-icon>Reschedule</ion-button>\n              <ion-button style=\"color: #3880ff;\" fill=\"\"><ion-icon color=\"primary\" slot=\"start\" name=\"chatbubble-ellipses\"></ion-icon>Chat</ion-button>\n            </div>\n          </ion-card-content>\n        </ion-card>  \n      </div> -->\n      \n    </div>\n  </div>\n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ApiService } from 'src/app/services/api/api.service';\nimport { CommonService } from 'src/app/services/common/common.service';\n\n@Component({\n  selector: 'app-search-results',\n  templateUrl: './search-results.page.html',\n  styleUrls: ['./search-results.page.scss'],\n})\nexport class SearchResultsPage implements OnInit {\n\n  public isSocketTrigger : boolean = false;\n\n  constructor(\n    public _router: Router,\n    public _api: ApiService,\n    public _commonService: CommonService\n  ) {\n    if(!this._commonService.searchResults.hasOwnProperty(\"fulfillments\"))\n    {\n      this._commonService.searchResults.fulfillments=[];\n    }\n    if(this._commonService.transaction_id==null || this._commonService.transaction_id==undefined)\n    {\n      this._router.navigate([\"/dashboard/\"]);\n    }\n  }\n\n  ngOnInit() {\n    setTimeout(() => {\n      this.get_onSearchData();\n    }, 500);\n    this._commonService.SOCKET.on('on_search', (data) => {\n      this.isSocketTrigger = true;\n    });\n  }\n\n  sortData(res: any)\n  {\n    if(res.status_code==200)\n    {\n      if(res.hasOwnProperty(\"context\") && res.hasOwnProperty(\"message\") && res.message.hasOwnProperty(\"catalog\"))\n      {\n        if(res.message.catalog.hasOwnProperty(\"fulfillments\"))\n        {\n          res.message.catalog.fulfillments.forEach(async (fulfillment) => {\n            res.message.catalog.items.forEach((item) => {\n              if(parseInt(fulfillment.id)==parseInt(item.fulfillment_id))\n              {\n                let fulfillmentObj = fulfillment;\n                fulfillmentObj[\"items\"] = item;\n                fulfillmentObj[\"context\"] = res.context;\n                let tempArr = JSON.stringify(fulfillmentObj);\n                this._commonService.searchResults.fulfillments.push(JSON.parse(tempArr));\n              }\n            });\n          });\n          if(this.isSocketTrigger)\n          {\n            this.isSocketTrigger = false;\n            this.get_onSearchData();\n          }\n        }\n      }\n    }\n    console.log(\"fulfillments count -> \",(this._commonService.searchResults.fulfillments).length);\n  }\n\n  get_onSearchData()\n  {\n    let param = {\n      \"transaction_id\": this._commonService.transaction_id\n    }\n    this._commonService.presentLoading(2000);\n    this._api.get_onSearchData(param).subscribe((res: any) => {\n      this._commonService.searchResults.fulfillments=[];\n      // this._commonService.presentLoading(3000);\n      res.data.forEach(data => {\n        if(data.hasOwnProperty(\"request_body\"))\n        {\n          var results = JSON.parse(data.request_body);\n          this.sortData(results);\n          \n          /*if(results.status_code==200 && results.hasOwnProperty(\"context\") && results.hasOwnProperty(\"message\") && results.message.hasOwnProperty(\"catalog\"))\n          {\n            // (results.message.catalog.providers).forEach(provider => {\n              results.message.catalog.fulfillments.forEach(fulfillment => {\n                var isDoctorAlreadyAdded = false;\n                for(var i=0; i<(this._commonService.searchResults).length;i++)\n                {\n                  if(this._commonService.searchResults[i].doctor_id == fulfillment.person.id)\n                  {\n                    isDoctorAlreadyAdded = true;\n                    break;\n                  }\n                };\n                if(!isDoctorAlreadyAdded)\n                {\n                  var expression = /[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)?/gi;\n                  var regex = new RegExp(expression);\n                  if(!fulfillment.person.image.match(regex)) {\n                    fulfillment.person.image = \"\";\n                  }\n\n                  // message.catalog.providers[0].fulfillments[0].quote.price.value\n                  this._commonService.searchResults.push({\n                    service_provider: results.message.catalog.descriptor.name,\n                    // provider_id: results.message.catalog.id,\n                    hospital_name: results.message.catalog.descriptor.name,\n                    doctor_name: fulfillment.person.name,\n                    doctor_id: fulfillment.person.id,\n                    doctor_gender: (fulfillment.person.gender).toLowerCase(),\n                    doctor_img: fulfillment.person.image,\n                    doctor_cred: fulfillment.person.cred,\n                    doctor_service_type: fulfillment.type==\"NA\"?\"\":fulfillment.type,\n                    doctor_service_category: \"\",\n                    quote: fulfillment.quote,\n                    start: fulfillment.start,\n                    end: fulfillment.end,\n                    item_id: null\n                  });\n                }\n              });\n\n              results.message.catalog.items.forEach(item => {\n                this._commonService.searchResults.forEach(doctor => {\n                  if(doctor.doctor_id==item.fulfillment_id)\n                  {\n                    doctor.item_id = item.id;\n                    // provider.categories.forEach(category => {\n                    //   if(category.id==item.category_id)\n                    //   {\n                    //     doctor.doctor_service_category = category.descriptor.name==\"NA\"?\"\":category.descriptor.name;\n                    //     doctor.item_id = item.id;\n                    //   }\n                    // });\n                  }\n                });\n\n              });\n              console.log(this._commonService.searchResults);\n            // });\n          }*/\n        }\n      });\n    }, (err) => {\n      if (err) {\n        console.error(err);\n      }\n    })\n  }\n\n  book_appointment(index: any,data: any)\n  {\n    this._commonService.presentLoading(1000);\n\n    // console.log(index);\n    this._router.navigate([\"/dashboard/book-appointment\",index]);\n    return;\n    \n    // var param = {\n    //   provider_id: data.provider_id,\n    //   item_id: data.item_id,\n    //   fulfillment_id: data.doctor_id,\n    //   transaction_id: this._commonService.transaction_id\n    // }\n    // console.log(data);\n    // this._router.navigate([\"/dashboard/search-results\"]);\n\n  //   this._api.select(param).subscribe((res: any) => {\n  //     console.log(res);\n  //     if(res.success && res.body.message.ack.status==\"ACK\")\n  //     {\n  //       this._router.navigate([\"/dashboard/book-appointment\"]);\n  //     }\n  //   }, (err) => {\n  //     if (err) {\n  //       console.error(err);\n  //     }\n  //   });\n  }\n}\n"]}